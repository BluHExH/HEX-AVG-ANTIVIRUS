rule EICAR_Test_String {
    meta:
        description = "EICAR Standard Antivirus Test File"
        author = "HEX-AVG Team"
        date = "2024-01-01"
        severity = "info"
    strings:
        $eicar = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*" nocase
    condition:
        $eicar
}

rule Suspicious_Packer {
    meta:
        description = "Detects common packer signatures"
        author = "HEX-AVG Team"
        severity = "high"
    strings:
        $upx = "UPX!" nocase
        $aspack = "ASPack" nocase
        $themida = "Themida" nocase
        $vmp = "VMProtect" nocase
    condition:
        any of them
}

rule PowerShell_DownloadString {
    meta:
        description = "Detects suspicious PowerShell download commands"
        author = "HEX-AVG Team"
        severity = "high"
    strings:
        $download = "DownloadString" nocase
        $invoke = "Invoke-Expression" nocase
        $web = "WebClient" nocase
    condition:
        $download and $invoke and $web
}

rule Suspicious_Base64 {
    meta:
        description = "Detects suspicious base64 encoded content"
        author = "HEX-AVG Team"
        severity = "medium"
    strings:
        $base64 = "FromBase64String" nocase
        $convert = "ConvertTo-SecureString" nocase
    condition:
        $base64 or $convert
}